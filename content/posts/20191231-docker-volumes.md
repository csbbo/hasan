---
title: "获取Docker中磁盘信息"
date: 2019-12-31T15:31:28+08:00
categories: ["Docker"]
tags: ["Docker", "Python", "psuitl"]
---

在项目中需要获取平台运行信息，但使用Docker部署时因为是隔离的环境所有的系统资源均为宿主机分配的资源，导致一般的检测方法无法获取真正的平台信息。

<!--more-->

要获取宿主机平台的一些信息如**CPU**，**内存**有那么两个办法:

+ 使用挂载宿主机目录方式获取宿主机信息。
    在启动容器的时候，挂载/proc/目录到指定目录，注意容器容也有proc目录，容器中不可再用/proc目录，然后根据cpuinfo或者其他文件自己提取数据再算出来

+ 在容器中使用ssh连接到主机获取主机信息


其实获取docker内的资源信息本身并没有什么大的问题，只是最近碰到了一个问题，客户端上传的文件到docker中的某个目录中，如果该目录是通过宿主机volumes进来的，这些目录并没有被docker计算在内，也就是说通过volumes进来的文件资源并不属于docker它仍然是宿主机的一部分。

如果使用命令`df -h`去查看volumes进来的文件资源会发现其实就是宿主机上的资源信息。在Python中通过`psutil.disk_usage('volumes dir path')`可以获取宿主机磁盘大小和使用等情况。