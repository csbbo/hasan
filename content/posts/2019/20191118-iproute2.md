---
title: "Iproute2"
date: 2019-11-18T14:21:08+08:00
categories: ["Linux"]
tags: ["iproute2"]
toc: true
---

iproute2是Linux上有关TCP／IP网络上的流量控制的一系列工具,这一系列的工具包括了ss、route、tc、ip。相比于net-tools中已经被废弃的ifconfig,iproute2套件里提供了许多增强功能的命令。

<!--more-->

### Linux net-tools VS iproute2

net-tools | iproute2
---|---
arp -na | ip neigh
ifconfig | ip link
ifconfig -a | ip addr show
ifconfig --help | ip help
ifconfig -s | ip -s link
ifconfig eth0 up | ip link eth0 up
ipmaddr | ip maddr
iptunnel | ip tunnel
netstat | ss
netstat -i | ip -s link
netstat -g | ip maddr
netstat -l | ss -l
netstat -r | ip route
route add | ip route add
route del | ip route del
route -n | ip route show
vconfig | ip link

### IP地址

要机器设置一个IP地址
```shell
ip addr add 192.168.0.193/24 dev wlan0
```

> 请注意IP地址要有一个后缀，比如/24。这种用法用于在无类域内路由选择（CIDR）中来显示所用的子网掩码。在这个例子中，子网掩码是255.255.255.0。

设置好IP地址后，需要查看是否已经生效

```shell
ip addr show wlan0
```

删除IP地址，只需用del代替add

```shell
ip addr del 192.168.0.193/24 dev wlan0
```

### 路由表

ip命令的路由对象的参数还可以帮助你查看网络中的路由数据，并设置你的路由表。第一个条目是默认的路由条目，你可以随意改动它。

```shell
ip route show
```

查看ip地址路由包来源

```shell
ip route get 10.42.0.47
```

更改默认路由

```shell
ip route add default via 192.168.0.196
```

### 网络数据

获取特定网络接口的信息

```shell
ip -s -s link ls p2p1
```
> 使用多个选项-s会给你这个特定接口更详细的信息。特别是在排除网络连接故障时，这会非常有用。

### ARP条目

ip命令的neigh或者neighbour选项，你可以查看接入你所在的局域网的设备的MAC地址。

```shell
ip neigh
```

### 监控netlink消息

ip命令查看netlink消息，monitor选项允许你查看网络设备的状态。比如，所在局域网的一台电脑根据它的状态可以被分类成REACHABLE或者STALE

```shell
ip monitor all
```

### 激活和停止网络接口

使用ip命令的up和down选项来激某个特定的接口

```shell
ip link set ppp0 down
ip link set ppp0 up
```

[参考]

[试试Linux下的ip命令，ifconfig已经过时了](https://linux.cn/article-3144-1.html)